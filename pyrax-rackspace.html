<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Managing rackspace products in SaltStack - GTmanfred</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://blog.gtmanfred.com/pyrax-rackspace.html">

        <meta name="author" content="Daniel Wallace" />
        <meta name="keywords" content="salt,rackspace,pyrax" />
        <meta name="description" content="How rackspace products should be organized in the SaltStack infrastructure." />

        <meta property="og:site_name" content="GTmanfred" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Managing rackspace products in SaltStack"/>
        <meta property="og:url" content="https://blog.gtmanfred.com/pyrax-rackspace.html"/>
        <meta property="og:description" content="How rackspace products should be organized in the SaltStack infrastructure."/>
        <meta property="article:published_time" content="2014-09-19" />
            <meta property="article:section" content="Salt" />
            <meta property="article:tag" content="salt" />
            <meta property="article:tag" content="rackspace" />
            <meta property="article:tag" content="pyrax" />
            <meta property="article:author" content="Daniel Wallace" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://blog.gtmanfred.com/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://blog.gtmanfred.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://blog.gtmanfred.com/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="https://blog.gtmanfred.com/theme/css/style.css" type="text/css"/>

        <link href="https://blog.gtmanfred.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="GTmanfred ATOM Feed"/>



        <link href="https://blog.gtmanfred.com/feeds/{slug}.atom.xml" type="application/atom+xml" rel="alternate"
              title="GTmanfred Salt ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://blog.gtmanfred.com/" class="navbar-brand">
GTmanfred            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="https://blog.gtmanfred.com/pages/about.html">
                             About
                          </a></li>
                        <li >
                            <a href="https://blog.gtmanfred.com/category/pelican.html">Pelican</a>
                        </li>
                        <li class="active">
                            <a href="https://blog.gtmanfred.com/category/salt.html">Salt</a>
                        </li>
                        <li >
                            <a href="https://blog.gtmanfred.com/category/zsh.html">Zsh</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://blog.gtmanfred.com/pyrax-rackspace.html"
                       rel="bookmark"
                       title="Permalink to Managing rackspace products in SaltStack">
                        Managing rackspace products in SaltStack
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2014-09-19T18:33:00-05:00"> Fri 19 September 2014</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://blog.gtmanfred.com/tag/salt.html">salt</a>
        /
	<a href="https://blog.gtmanfred.com/tag/rackspace.html">rackspace</a>
        /
	<a href="https://blog.gtmanfred.com/tag/pyrax.html">pyrax</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h1>How everything is setup now.</h1>
<p>Currently we have been keeping all the individual drivers seperate, controlling 
all the behavior so that you get the same experience no matter which provider 
you use. I would like to keep doing this even though we are adding stuff that is
more specific.</p>
<p>The goal will be to continue to only use the CloudClient interface, and just run
everything through that so that we can write the code once, and have it 
available to all of the different cloud modules/runner/state/salt-cloud.</p>
<h1>Getting Started</h1>
<p>I want to start this one cleanly and not run into the problems that happened 
with the novaclient driver.  Starting with salt.utils.openstack.pyrax, 
__init__.py should look something like this</p>
<h2>salt/utils/openstack/pyrax/__init__.py</h2>
<div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">with_statement</span><span class="p">,</span> <span class="n">generators</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">pyrax</span>

        <span class="c1"># import pyrax classes</span>
        <span class="kn">from</span> <span class="nn">salt.utils.openstack.pyrax.authentication</span> <span class="kn">import</span> <span class="n">Auth</span>

        <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;Auth&#39;</span> <span class="p">]</span>
        <span class="n">HAS_PYRAX</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">HAS_PYRAX</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>


<p>This will keep everything imported when we just import
salt.utils.openstack.pyrax but if pyrax is not installed, it doesn't try to 
import it a bunch more times on all the other files.  </p>
<p>Once this has begun, there will be the main class, that gets authenticated and 
does the _get_conn just like all the other drivers do, but then, we can just 
pass the authenticated object to all the new classes, instead of authenticating 
on each new one.</p>
<p>After these have gotten started, everything needs to then be referenced in salt.
cloud.clouds.pyrax, and that just uses the classes from the utils directory.<br>
This is the code I am writing right now, and once it is finished, it will make 
it really easy for anyone to just add another class in another file and then 
hook it into the salt-cloud pyrax driver.</p>
<h1>What is next?</h1>
<p>I have to write the authentication and servers class, since those are what 
everything revolves around.  Once those are done, we can start expanding and 
have everyone come in and start adding Cloud Things!</p>
<p>From the point that it is up, everything should be easy enough to run through 
the cloud.action module.  Using the cloud.action module, I want to make one 
pyrax state that does all the things.</p>
<p>I am definitely going to get the first pyrax authentication class and stuff done
this weekend, and am going to start with it in my gtmanfred/salt repo in the 
pyrax branch.  Look for that on Saturday or Sunday this weekend.</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'gtmanfred'; // required: replace example with your forum shortname

            var disqus_config = function () {
                this.language = "en";

                        this.page.identifier = '2014-09-19-pyrax-rackspace';
                        this.page.url = 'https://blog.gtmanfred.com/pyrax-rackspace.html';
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Links -->
<li class="list-group-item">
  <h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
  <ul class="list-group" id="links">
    <li class="list-group-item">
      <a href="https://github.com/gtmanfred/" target="_blank">Git Repositories</a>
    </li>
    <li class="list-group-item">
      <a href="/feeds/" target="_blank">Feeds</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Links -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2017 Daniel Wallace
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://blog.gtmanfred.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://blog.gtmanfred.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://blog.gtmanfred.com/theme/js/respond.min.js"></script>


    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'gtmanfred'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-42514099-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->


</body>
</html>